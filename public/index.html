<!DOCTYPE html>
<html lang="it">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>IntelliMark.ai - Analisi Avanzata Marchi</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.1/css/all.min.css">
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700;800&display=swap" rel="stylesheet">
    <style>
        * { font-family: 'Inter', sans-serif; }
        
        /* CSS Variables */
        :root {
            --color-primary: #3b82f6;
            --color-primary-dark: #2563eb;
            --color-secondary: #6366f1;
            --color-success: #10b981;
            --color-warning: #f59e0b;
            --color-danger: #ef4444;
            --color-slate-50: #f8fafc;
            --color-slate-100: #f1f5f9;
            --color-slate-200: #e2e8f0;
            --color-slate-300: #cbd5e1;
            --color-slate-700: #334155;
            --color-slate-800: #1e293b;
            --color-slate-900: #0f172a;
        }
        
        /* Gradient Background */
        body {
            background: linear-gradient(135deg, #f6f9fc 0%, #e9f1ff 100%);
            min-height: 100vh;
        }
        
        /* Premium Card Styles */
        .premium-card {
            background: white;
            border-radius: 16px;
            box-shadow: 0 4px 24px rgba(0, 0, 0, 0.06);
            border: 1px solid rgba(0, 0, 0, 0.05);
            transition: all 0.3s ease;
        }
        
        .premium-card:hover {
            box-shadow: 0 8px 32px rgba(0, 0, 0, 0.08);
        }
        
        /* Gradient Text */
        .gradient-text {
            background: linear-gradient(135deg, var(--color-primary) 0%, var(--color-secondary) 100%);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
        }
        
        /* Premium Button */
        .btn-premium {
            background: linear-gradient(135deg, var(--color-primary) 0%, var(--color-secondary) 100%);
            color: white;
            padding: 12px 32px;
            border-radius: 8px;
            font-weight: 600;
            transition: all 0.3s ease;
            box-shadow: 0 4px 16px rgba(99, 102, 241, 0.3);
        }
        
        .btn-premium:hover {
            transform: translateY(-2px);
            box-shadow: 0 8px 24px rgba(99, 102, 241, 0.4);
        }
        
        .btn-premium:disabled {
            opacity: 0.7;
            cursor: not-allowed;
            transform: none;
        }
        
        /* Form Inputs */
        .form-input {
            width: 100%;
            padding: 12px 16px;
            border: 2px solid var(--color-slate-200);
            border-radius: 8px;
            transition: all 0.2s ease;
            font-size: 16px;
        }
        
        .form-input:focus {
            outline: none;
            border-color: var(--color-primary);
            box-shadow: 0 0 0 3px rgba(59, 130, 246, 0.1);
        }
        
        /* Country Pills */
        .country-pill {
            display: inline-flex;
            align-items: center;
            padding: 8px 16px;
            background: var(--color-slate-100);
            border: 2px solid transparent;
            border-radius: 24px;
            cursor: pointer;
            transition: all 0.2s ease;
            font-weight: 500;
        }
        
        .country-pill:hover {
            background: var(--color-slate-200);
        }
        
        .country-pill.selected {
            background: var(--color-primary);
            color: white;
            border-color: var(--color-primary);
        }
        
        /* Score Display */
        .score-display {
            position: relative;
            width: 160px;
            height: 160px;
            margin: 0 auto;
        }
        
        .score-circle {
            transform: rotate(-90deg);
        }
        
        .score-value {
            position: absolute;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            font-size: 3rem;
            font-weight: 700;
        }
        
        /* Loading Animation */
        @keyframes pulse {
            0%, 100% { opacity: 1; }
            50% { opacity: 0.5; }
        }
        
        .loading-pulse {
            animation: pulse 2s cubic-bezier(0.4, 0, 0.6, 1) infinite;
        }
        
        /* Result Cards */
        .result-card {
            background: var(--color-slate-50);
            border: 1px solid var(--color-slate-200);
            border-radius: 12px;
            padding: 24px;
            transition: all 0.3s ease;
        }
        
        .result-card:hover {
            background: white;
            box-shadow: 0 4px 16px rgba(0, 0, 0, 0.05);
        }
        
        /* Badge Styles */
        .badge {
            display: inline-flex;
            align-items: center;
            padding: 4px 12px;
            border-radius: 16px;
            font-size: 0.875rem;
            font-weight: 600;
        }
        
        .badge-success {
            background: #d1fae5;
            color: #065f46;
        }
        
        .badge-warning {
            background: #fed7aa;
            color: #92400e;
        }
        
        .badge-danger {
            background: #fee2e2;
            color: #991b1b;
        }
        
        /* Judgment Content Styles */
        .judgment-content strong { 
            color: var(--color-slate-900); 
            font-weight: 600; 
        }
        
        .judgment-content .highlight { 
            background-color: #e0e7ff; 
            color: #3730a3; 
            padding: 2px 6px; 
            border-radius: 4px; 
            font-weight: 500; 
            display: inline-block;
        }
        
        .judgment-content h4 {
            font-size: 1.125rem;
            font-weight: 700;
            margin-bottom: 0.75rem;
            margin-top: 1rem;
            color: var(--color-slate-900);
        }
        
        .judgment-content h4:first-child {
            margin-top: 0;
        }
        
        .judgment-content p {
            margin-bottom: 0.75rem;
            line-height: 1.6;
        }
        
        .judgment-content p:last-child {
            margin-bottom: 0;
        }
        
        .judgment-content ul, .judgment-content ol {
            margin-left: 1.5rem;
            margin-bottom: 0.75rem;
        }
        
        .judgment-content li {
            margin-bottom: 0.25rem;
        }
        
        /* Image Upload Styles */
        .image-upload-area {
            border: 2px dashed var(--color-slate-300);
            border-radius: 12px;
            padding: 32px;
            text-align: center;
            transition: all 0.3s ease;
            cursor: pointer;
            background: var(--color-slate-50);
        }
        
        .image-upload-area:hover {
            border-color: var(--color-primary);
            background: white;
        }
        
        .image-upload-area.drag-over {
            border-color: var(--color-primary);
            background: rgba(59, 130, 246, 0.05);
        }
        
        .image-preview {
            max-width: 200px;
            max-height: 200px;
            margin: 0 auto;
            border-radius: 8px;
            overflow: hidden;
            box-shadow: 0 4px 16px rgba(0, 0, 0, 0.1);
        }
        
        .image-preview img {
            width: 100%;
            height: 100%;
            object-fit: contain;
        }
        
        /* Figurative Mark Card */
        .figurative-mark-card {
            display: flex;
            gap: 16px;
            padding: 16px;
            background: white;
            border-radius: 8px;
            border: 1px solid var(--color-slate-200);
            transition: all 0.3s ease;
        }
        
        .figurative-mark-card:hover {
            border-color: var(--color-primary);
            box-shadow: 0 4px 16px rgba(0, 0, 0, 0.08);
        }
        
        .figurative-mark-image {
            width: 80px;
            height: 80px;
            border-radius: 8px;
            overflow: hidden;
            flex-shrink: 0;
            background: var(--color-slate-100);
        }
        
        .figurative-mark-image img {
            width: 100%;
            height: 100%;
            object-fit: contain;
        }
        
        /* Tabs */
        .tab-button {
            padding: 12px 24px;
            border-radius: 8px 8px 0 0;
            font-weight: 600;
            transition: all 0.2s ease;
            border-bottom: 3px solid transparent;
        }
        
        .tab-button:hover {
            background: var(--color-slate-100);
        }
        
        .tab-button.active {
            color: var(--color-primary);
            border-bottom-color: var(--color-primary);
            background: white;
        }
        
        /* FAQ Styles */
        .faq-item {
            border-bottom: 1px solid var(--color-slate-200);
            padding: 20px 0;
        }
        
        .faq-item:last-child {
            border-bottom: none;
        }
        
        .faq-question {
            cursor: pointer;
            display: flex;
            justify-content: space-between;
            align-items: center;
            font-weight: 600;
            color: var(--color-slate-800);
            transition: color 0.2s ease;
        }
        
        .faq-question:hover {
            color: var(--color-primary);
        }
        
        .faq-answer {
            max-height: 0;
            overflow: hidden;
            transition: max-height 0.3s ease-out;
            color: var(--color-slate-600);
            padding-top: 0;
        }
        
        .faq-item.active .faq-answer {
            max-height: 500px;
            padding-top: 12px;
        }
        
        .faq-icon {
            transition: transform 0.3s ease;
        }
        
        .faq-item.active .faq-icon {
            transform: rotate(180deg);
        }
        
        /* Search Type Radio Styles */
        input[type="radio"][name="searchType"] {
            accent-color: var(--color-primary);
        }
        
        input[type="radio"][name="searchType"]:checked + div {
            color: var(--color-primary);
        }
        
        input[type="radio"][name="searchType"]:checked ~ * {
            --tw-border-opacity: 1;
            border-color: rgb(59 130 246 / var(--tw-border-opacity));
            background-color: rgba(59, 130, 246, 0.05);
        }
        
        /* Smooth Transitions */
        .fade-in {
            animation: fadeIn 0.5s ease-out;
        }
        
        @keyframes fadeIn {
            from {
                opacity: 0;
                transform: translateY(10px);
            }
            to {
                opacity: 1;
                transform: translateY(0);
            }
        }
    </style>
</head>
<body>
    <!-- Header -->
    <header class="bg-white border-b border-slate-200 sticky top-0 z-50">
        <div class="container mx-auto px-4 py-4">
            <div class="flex justify-between items-center">
                <div class="flex items-center gap-3">
                    <div class="w-10 h-10 bg-gradient-to-br from-blue-500 to-indigo-600 rounded-lg flex items-center justify-center">
                        <i class="fas fa-shield-alt text-white"></i>
                    </div>
                    <h1 class="text-2xl font-bold gradient-text">IntelliMark.ai</h1>
                </div>
                <nav class="hidden md:flex gap-6">
                    <a href="#home" class="text-slate-700 hover:text-primary transition-colors">Home</a>
                    <a href="#analysis" class="text-slate-700 hover:text-primary transition-colors">Analisi</a>
                    <a href="#faq" class="text-slate-700 hover:text-primary transition-colors">FAQ</a>
                    <a href="#contact" class="text-slate-700 hover:text-primary transition-colors">Contatti</a>
                </nav>
            </div>
        </div>
    </header>

    <!-- Hero Section -->
    <section id="home" class="py-20">
        <div class="container mx-auto px-4">
            <div class="max-w-4xl mx-auto text-center">
                <h2 class="text-5xl font-bold text-slate-900 mb-6">
                    Proteggi il tuo brand con l'AI
                </h2>
                <p class="text-xl text-slate-600 mb-8">
                    Analisi avanzata della registrabilità dei marchi con intelligenza artificiale,
                    ricerca su database EUIPO e confronto visivo automatizzato
                </p>
                <div class="flex flex-wrap gap-4 justify-center">
                    <a href="#analysis" class="btn-premium">
                        <i class="fas fa-search mr-2"></i>
                        Inizia l'Analisi
                    </a>
                    <button class="px-6 py-3 border-2 border-slate-300 rounded-lg font-semibold hover:border-slate-400 transition-colors">
                        <i class="fas fa-play-circle mr-2"></i>
                        Guarda il Video
                    </button>
                </div>
            </div>
        </div>
    </section>

    <!-- Analysis Section (moved up) -->
    <section id="analysis" class="py-20 bg-slate-50">
        <div class="container mx-auto px-4">
            <div class="max-w-6xl mx-auto">
                <h2 class="text-3xl font-bold text-center mb-12">Analizza il tuo marchio</h2>
                
                <!-- Search Form -->
                <div class="premium-card p-8 mb-8">
                    <form id="searchForm">
                        <!-- Search Type Selection -->
                        <div class="mb-6">
                            <label class="block text-sm font-semibold text-slate-700 mb-3">
                                <i class="fas fa-filter mr-1"></i>
                                Tipo di Ricerca
                            </label>
                            <div class="grid grid-cols-1 md:grid-cols-3 gap-4">
                                <label class="flex items-center p-4 border-2 border-slate-200 rounded-lg cursor-pointer hover:border-primary transition-colors">
                                    <input type="radio" name="searchType" value="verbal" class="mr-3" checked>
                                    <div>
                                        <div class="font-semibold">Marchio Denominativo</div>
                                        <div class="text-sm text-slate-600">Solo analisi testuale</div>
                                    </div>
                                </label>
                                <label class="flex items-center p-4 border-2 border-slate-200 rounded-lg cursor-pointer hover:border-primary transition-colors">
                                    <input type="radio" name="searchType" value="figurative" class="mr-3">
                                    <div>
                                        <div class="font-semibold">Marchio Figurativo</div>
                                        <div class="text-sm text-slate-600">Solo analisi visiva</div>
                                    </div>
                                </label>
                                <label class="flex items-center p-4 border-2 border-slate-200 rounded-lg cursor-pointer hover:border-primary transition-colors">
                                    <input type="radio" name="searchType" value="combined" class="mr-3">
                                    <div>
                                        <div class="font-semibold">Marchio Complesso</div>
                                        <div class="text-sm text-slate-600">Analisi testuale + visiva</div>
                                    </div>
                                </label>
                            </div>
                        </div>
                        
                        <div class="grid grid-cols-1 lg:grid-cols-2 gap-6 mb-6">
                            <!-- Brand Name Input -->
                            <div id="brandNameContainer">
                                <label class="block text-sm font-semibold text-slate-700 mb-2">
                                    <i class="fas fa-tag mr-1"></i>
                                    Nome del Brand
                                </label>
                                <input 
                                    type="text" 
                                    id="brandName" 
                                    class="form-input" 
                                    placeholder="Es. TechVision"
                                    required
                                >
                            </div>
                            
                            <!-- Image Upload -->
                            <div id="imageUploadContainer">
                                <label class="block text-sm font-semibold text-slate-700 mb-2">
                                    <i class="fas fa-image mr-1"></i>
                                    Logo/Marchio Figurativo
                                </label>
                                <div id="imageUploadArea" class="image-upload-area">
                                    <input type="file" id="imageInput" accept="image/*" class="hidden">
                                    <div id="uploadPlaceholder">
                                        <i class="fas fa-cloud-upload-alt text-4xl text-slate-400 mb-2"></i>
                                        <p class="text-slate-600">Clicca o trascina un'immagine qui</p>
                                        <p class="text-sm text-slate-500">PNG, JPG, GIF fino a 10MB</p>
                                    </div>
                                    <div id="imagePreviewContainer" class="hidden">
                                        <div class="image-preview">
                                            <img id="imagePreview" alt="Preview">
                                        </div>
                                        <button type="button" id="removeImage" class="mt-4 text-red-600 hover:text-red-700 font-medium">
                                            <i class="fas fa-trash mr-1"></i>
                                            Rimuovi immagine
                                        </button>
                                    </div>
                                </div>
                            </div>
                        </div>
                        
                        <!-- Product Description -->
                        <div class="mb-6">
                            <label class="block text-sm font-semibold text-slate-700 mb-2">
                                <i class="fas fa-box mr-1"></i>
                                Descrizione Prodotti/Servizi
                            </label>
                            <textarea 
                                id="productDescription" 
                                class="form-input" 
                                rows="3" 
                                placeholder="Descrivi i prodotti o servizi che offrirai con questo marchio..."
                                required
                            ></textarea>
                        </div>
                        
                        <!-- Country Selection -->
                        <div class="mb-8">
                            <label class="block text-sm font-semibold text-slate-700 mb-3">
                                <i class="fas fa-globe mr-1"></i>
                                Territori di Interesse
                            </label>
                            <div class="flex flex-wrap gap-3" id="countrySelection">
                                <button type="button" class="country-pill" data-country="EU">
                                    <img src="https://flagcdn.com/16x12/eu.png" alt="EU" class="mr-2">
                                    Unione Europea
                                </button>
                                <button type="button" class="country-pill" data-country="IT">
                                    <img src="https://flagcdn.com/16x12/it.png" alt="IT" class="mr-2">
                                    Italia
                                </button>
                                <button type="button" class="country-pill" data-country="US">
                                    <img src="https://flagcdn.com/16x12/us.png" alt="US" class="mr-2">
                                    Stati Uniti
                                </button>
                                <button type="button" class="country-pill" data-country="UK">
                                    <img src="https://flagcdn.com/16x12/gb.png" alt="UK" class="mr-2">
                                    Regno Unito
                                </button>
                                <button type="button" class="country-pill" data-country="CN">
                                    <img src="https://flagcdn.com/16x12/cn.png" alt="CN" class="mr-2">
                                    Cina
                                </button>
                            </div>
                        </div>
                        
                        <!-- Submit Button -->
                        <div class="text-center">
                            <button type="submit" class="btn-premium" id="submitBtn">
                                <i class="fas fa-search mr-2"></i>
                                Avvia Analisi Completa
                            </button>
                        </div>
                    </form>
                </div>

                <!-- Loading State -->
                <div id="loadingState" class="hidden">
                    <div class="premium-card p-12 text-center">
                        <div class="loading-pulse mb-6">
                            <i class="fas fa-brain text-6xl text-blue-500"></i>
                        </div>
                        <h3 class="text-2xl font-bold mb-2">Analisi in corso...</h3>
                        <p class="text-slate-600" id="loadingMessage">Interrogazione database EUIPO</p>
                        <div class="mt-6 flex justify-center gap-2">
                            <div class="w-2 h-2 bg-blue-500 rounded-full animate-bounce" style="animation-delay: 0s"></div>
                            <div class="w-2 h-2 bg-blue-500 rounded-full animate-bounce" style="animation-delay: 0.1s"></div>
                            <div class="w-2 h-2 bg-blue-500 rounded-full animate-bounce" style="animation-delay: 0.2s"></div>
                        </div>
                    </div>
                </div>

                <!-- Results Section -->
                <div id="resultsSection" class="hidden space-y-8">
                    <!-- Score Card -->
                    <div class="premium-card p-8 fade-in" id="scoreCard">
                        <div class="grid grid-cols-1 md:grid-cols-2 gap-8 items-center">
                            <div>
                                <h3 class="text-2xl font-bold mb-4">
                                    <span class="gradient-text">Brand Potential Score™</span>
                                </h3>
                                <p class="text-slate-600 mb-6">
                                    Valutazione complessiva basata su analisi AI, anteriorità rilevate e confronto visivo
                                </p>
                                <div class="space-y-3">
                                    <div class="flex items-center gap-3">
                                        <i class="fas fa-check-circle text-green-500"></i>
                                        <span class="text-slate-700">Analisi semantica completata</span>
                                    </div>
                                    <div class="flex items-center gap-3">
                                        <i class="fas fa-check-circle text-green-500"></i>
                                        <span class="text-slate-700">Database EUIPO consultato</span>
                                    </div>
                                    <div class="flex items-center gap-3" id="imageAnalysisCheck" style="display: none;">
                                        <i class="fas fa-check-circle text-green-500"></i>
                                        <span class="text-slate-700">Analisi figurativa completata</span>
                                    </div>
                                </div>
                            </div>
                            <div>
                                <div class="score-display">
                                    <svg class="score-circle" width="160" height="160">
                                        <circle cx="80" cy="80" r="70" stroke="#e5e7eb" stroke-width="12" fill="none"></circle>
                                        <circle 
                                            id="scoreCircle"
                                            cx="80" cy="80" r="70" 
                                            stroke="url(#gradient)" 
                                            stroke-width="12" 
                                            fill="none"
                                            stroke-dasharray="440"
                                            stroke-dashoffset="440"
                                            stroke-linecap="round"
                                        ></circle>
                                        <defs>
                                            <linearGradient id="gradient" x1="0%" y1="0%" x2="100%" y2="100%">
                                                <stop offset="0%" style="stop-color:#3b82f6" />
                                                <stop offset="100%" style="stop-color:#6366f1" />
                                            </linearGradient>
                                        </defs>
                                    </svg>
                                    <div class="score-value">
                                        <span id="scoreValue" class="gradient-text">0</span>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>

                    <!-- AI Classes -->
                    <div class="premium-card p-8 fade-in" id="classesCard">
                        <h3 class="text-xl font-bold mb-4">
                            <i class="fas fa-layer-group mr-2 text-blue-500"></i>
                            Classi di Nizza Identificate
                        </h3>
                        <div class="grid grid-cols-1 md:grid-cols-2 gap-4" id="aiClassesContainer">
                            <!-- Classes will be inserted here -->
                        </div>
                    </div>

                    <!-- Image Analysis Results (if applicable) -->
                    <div class="premium-card p-8 fade-in" id="imageAnalysisCard" style="display: none;">
                        <h3 class="text-xl font-bold mb-4">
                            <i class="fas fa-image mr-2 text-purple-500"></i>
                            Analisi Marchio Figurativo
                        </h3>
                        <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
                            <div>
                                <h4 class="font-semibold text-slate-700 mb-2">Elementi Visivi Identificati</h4>
                                <p class="text-slate-600 mb-4" id="imageDescription"></p>
                                <h4 class="font-semibold text-slate-700 mb-2">Elementi Distintivi</h4>
                                <div class="flex flex-wrap gap-2" id="distinctiveElements"></div>
                            </div>
                            <div>
                                <h4 class="font-semibold text-slate-700 mb-2">Codici di Vienna</h4>
                                <div class="space-y-2" id="viennaCodes"></div>
                            </div>
                        </div>
                    </div>

                    <!-- Results Tabs -->
                    <div class="premium-card p-0 fade-in">
                        <div class="border-b border-slate-200">
                            <div class="flex">
                                <button class="tab-button active" data-tab="judgment">
                                    <i class="fas fa-gavel mr-2"></i>
                                    Giudizio Legale
                                </button>
                                <button class="tab-button" data-tab="verbal">
                                    <i class="fas fa-font mr-2"></i>
                                    Marchi Verbali
                                </button>
                                <button class="tab-button" data-tab="figurative" id="figurativeTabButton" style="display: none;">
                                    <i class="fas fa-image mr-2"></i>
                                    Marchi Figurativi
                                </button>
                            </div>
                        </div>
                        
                        <!-- Tab Contents -->
                        <div class="p-8">
                            <!-- Judgment Tab -->
                            <div id="judgmentTab" class="tab-content">
                                <div class="flex items-start gap-4 mb-6">
                                    <div id="judgmentIcon" class="text-3xl">
                                        <i class="fas fa-check-circle text-green-500"></i>
                                    </div>
                                    <div class="flex-1">
                                        <h4 id="judgmentSummary" class="text-xl font-bold mb-2"></h4>
                                        <div id="judgmentDetails" class="judgment-content text-slate-700"></div>
                                    </div>
                                </div>
                            </div>
                            
                            <!-- Verbal Marks Tab -->
                            <div id="verbalTab" class="tab-content hidden">
                                <h4 class="font-semibold text-lg mb-4">Marchi Verbali Anteriori</h4>
                                <div class="space-y-4" id="verbalMarksContainer">
                                    <!-- Verbal marks will be inserted here -->
                                </div>
                            </div>
                            
                            <!-- Figurative Marks Tab -->
                            <div id="figurativeTab" class="tab-content hidden">
                                <h4 class="font-semibold text-lg mb-4">Marchi Figurativi Simili</h4>
                                <div class="space-y-4" id="figurativeMarksContainer">
                                    <!-- Figurative marks will be inserted here -->
                                </div>
                            </div>
                        </div>
                    </div>

                    <!-- Action Buttons -->
                    <div class="flex flex-wrap gap-4 justify-center fade-in">
                        <button id="downloadReport" class="px-6 py-3 bg-slate-800 text-white rounded-lg font-semibold hover:bg-slate-700 transition-colors">
                            <i class="fas fa-download mr-2"></i>
                            Scarica Report PDF
                        </button>
                        <button id="newSearch" class="px-6 py-3 border-2 border-slate-300 rounded-lg font-semibold hover:border-slate-400 transition-colors">
                            <i class="fas fa-redo mr-2"></i>
                            Nuova Ricerca
                        </button>
                    </div>
                </div>
            </div>
        </div>
    </section>

    <!-- Features Section -->
    <section class="py-16">
        <div class="container mx-auto px-4">
            <div class="grid grid-cols-1 md:grid-cols-3 gap-8 max-w-6xl mx-auto">
                <div class="premium-card p-8 text-center">
                    <div class="w-16 h-16 bg-blue-100 rounded-full flex items-center justify-center mx-auto mb-4">
                        <i class="fas fa-brain text-2xl text-blue-600"></i>
                    </div>
                    <h3 class="text-xl font-bold mb-2">AI Avanzata</h3>
                    <p class="text-slate-600">Analisi semantica e visiva con Gemini Pro per valutazioni precise</p>
                </div>
                <div class="premium-card p-8 text-center">
                    <div class="w-16 h-16 bg-indigo-100 rounded-full flex items-center justify-center mx-auto mb-4">
                        <i class="fas fa-database text-2xl text-indigo-600"></i>
                    </div>
                    <h3 class="text-xl font-bold mb-2">Database EUIPO</h3>
                    <p class="text-slate-600">Ricerca in tempo reale su milioni di marchi registrati nell'UE</p>
                </div>
                <div class="premium-card p-8 text-center">
                    <div class="w-16 h-16 bg-purple-100 rounded-full flex items-center justify-center mx-auto mb-4">
                        <i class="fas fa-eye text-2xl text-purple-600"></i>
                    </div>
                    <h3 class="text-xl font-bold mb-2">Confronto Visivo</h3>
                    <p class="text-slate-600">Analisi automatica della similarità tra marchi figurativi</p>
                </div>
            </div>
        </div>
    </section>

    <!-- FAQ Section -->
    <section id="faq" class="py-20 bg-slate-50">
        <div class="container mx-auto px-4">
            <div class="max-w-3xl mx-auto">
                <h2 class="text-3xl font-bold text-center mb-12">Domande Frequenti</h2>
                <div class="premium-card p-8">
                    <div class="faq-item">
                        <div class="faq-question">
                            <span>Come funziona l'analisi AI dei marchi?</span>
                            <i class="fas fa-chevron-down faq-icon"></i>
                        </div>
                        <div class="faq-answer">
                            Il nostro sistema utilizza l'intelligenza artificiale Gemini Pro per analizzare il nome del brand, 
                            i prodotti/servizi e l'eventuale logo. L'AI identifica le classi di Nizza pertinenti, 
                            cerca marchi simili nel database EUIPO e fornisce un giudizio legale dettagliato con riferimenti normativi.
                        </div>
                    </div>
                    <div class="faq-item">
                        <div class="faq-question">
                            <span>Quanto è affidabile il Brand Potential Score™?</span>
                            <i class="fas fa-chevron-down faq-icon"></i>
                        </div>
                        <div class="faq-answer">
                            Il punteggio è calcolato utilizzando un algoritmo che considera molteplici fattori: 
                            numero e stato dei marchi simili, grado di similarità verbale e visiva, 
                            affinità merceologica e valutazione del rischio legale. 
                            Fornisce un'indicazione affidabile ma non sostituisce una consulenza legale professionale.
                        </div>
                    </div>
                    <div class="faq-item">
                        <div class="faq-question">
                            <span>Posso utilizzare il report per una domanda di registrazione?</span>
                            <i class="fas fa-chevron-down faq-icon"></i>
                        </div>
                        <div class="faq-answer">
                            Il report fornisce informazioni preziose per valutare la registrabilità del marchio, 
                            ma consigliamo di consultare un avvocato specializzato in proprietà intellettuale 
                            prima di procedere con una domanda di registrazione ufficiale.
                        </div>
                    </div>
                    <div class="faq-item">
                        <div class="faq-question">
                            <span>Come funziona il confronto dei marchi figurativi?</span>
                            <i class="fas fa-chevron-down faq-icon"></i>
                        </div>
                        <div class="faq-answer">
                            Quando carichi un'immagine del tuo logo, l'AI analizza gli elementi visivi, 
                            identifica i codici di Vienna pertinenti e cerca marchi figurativi simili nel database EUIPO. 
                            Il sistema confronta poi visivamente i marchi trovati con il tuo, 
                            valutando la similarità e il rischio di confusione.
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </section>

    <!-- Footer -->
    <footer class="bg-slate-900 text-white py-12">
        <div class="container mx-auto px-4">
            <div class="text-center">
                <div class="flex items-center justify-center gap-3 mb-4">
                    <div class="w-10 h-10 bg-gradient-to-br from-blue-500 to-indigo-600 rounded-lg flex items-center justify-center">
                        <i class="fas fa-shield-alt text-white"></i>
                    </div>
                    <h3 class="text-2xl font-bold">IntelliMark.ai</h3>
                </div>
                <p class="text-slate-400 mb-6">
                    Analisi professionale dei marchi con intelligenza artificiale
                </p>
                <div class="flex gap-6 justify-center">
                    <a href="#" class="text-slate-400 hover:text-white transition-colors">
                        <i class="fab fa-linkedin text-xl"></i>
                    </a>
                    <a href="#" class="text-slate-400 hover:text-white transition-colors">
                        <i class="fab fa-twitter text-xl"></i>
                    </a>
                    <a href="#" class="text-slate-400 hover:text-white transition-colors">
                        <i class="fas fa-envelope text-xl"></i>
                    </a>
                </div>
                <p class="text-sm text-slate-500 mt-8">
                    © 2024 IntelliMark.ai. Tutti i diritti riservati.
                </p>
            </div>
        </div>
    </footer>

    <script>
        // DOM Elements
        const elements = {
            searchForm: document.getElementById('searchForm'),
            brandName: document.getElementById('brandName'),
            productDescription: document.getElementById('productDescription'),
            countrySelection: document.getElementById('countrySelection'),
            imageInput: document.getElementById('imageInput'),
            imageUploadArea: document.getElementById('imageUploadArea'),
            uploadPlaceholder: document.getElementById('uploadPlaceholder'),
            imagePreviewContainer: document.getElementById('imagePreviewContainer'),
            imagePreview: document.getElementById('imagePreview'),
            removeImage: document.getElementById('removeImage'),
            submitBtn: document.getElementById('submitBtn'),
            loadingState: document.getElementById('loadingState'),
            loadingMessage: document.getElementById('loadingMessage'),
            resultsSection: document.getElementById('resultsSection'),
            scoreCard: document.getElementById('scoreCard'),
            scoreValue: document.getElementById('scoreValue'),
            scoreCircle: document.getElementById('scoreCircle'),
            classesCard: document.getElementById('classesCard'),
            aiClassesContainer: document.getElementById('aiClassesContainer'),
            imageAnalysisCard: document.getElementById('imageAnalysisCard'),
            imageAnalysisCheck: document.getElementById('imageAnalysisCheck'),
            imageDescription: document.getElementById('imageDescription'),
            distinctiveElements: document.getElementById('distinctiveElements'),
            viennaCodes: document.getElementById('viennaCodes'),
            judgmentIcon: document.getElementById('judgmentIcon'),
            judgmentSummary: document.getElementById('judgmentSummary'),
            judgmentDetails: document.getElementById('judgmentDetails'),
            verbalMarksContainer: document.getElementById('verbalMarksContainer'),
            figurativeMarksContainer: document.getElementById('figurativeMarksContainer'),
            figurativeTabButton: document.getElementById('figurativeTabButton'),
            downloadReport: document.getElementById('downloadReport'),
            newSearch: document.getElementById('newSearch')
        };

        // State
        let selectedCountries = ['EU'];
        let uploadedImage = null;
        let currentResults = null;
        let selectedSearchType = 'verbal';

        // Initialize
        document.addEventListener('DOMContentLoaded', () => {
            initializeCountrySelection();
            initializeImageUpload();
            initializeTabs();
            initializeFAQ();
            initializeFormHandlers();
            initializeSearchTypeHandlers();
        });

        // Search Type Handlers
        function initializeSearchTypeHandlers() {
            const searchTypeInputs = document.querySelectorAll('input[name="searchType"]');
            const brandNameContainer = document.getElementById('brandNameContainer');
            const imageUploadContainer = document.getElementById('imageUploadContainer');
            const brandNameInput = document.getElementById('brandName');
            const imageInput = document.getElementById('imageInput');
            
            searchTypeInputs.forEach(input => {
                input.addEventListener('change', (e) => {
                    selectedSearchType = e.target.value;
                    
                    // Update UI based on search type
                    switch(selectedSearchType) {
                        case 'verbal':
                            brandNameContainer.style.display = 'block';
                            imageUploadContainer.style.display = 'none';
                            brandNameInput.required = true;
                            // Clear image if switching from other types
                            if (uploadedImage) {
                                uploadedImage = null;
                                elements.imageInput.value = '';
                                elements.uploadPlaceholder.classList.remove('hidden');
                                elements.imagePreviewContainer.classList.add('hidden');
                            }
                            break;
                            
                        case 'figurative':
                            brandNameContainer.style.display = 'none';
                            imageUploadContainer.style.display = 'block';
                            brandNameInput.required = false;
                            brandNameInput.value = ''; // Clear brand name
                            break;
                            
                        case 'combined':
                            brandNameContainer.style.display = 'block';
                            imageUploadContainer.style.display = 'block';
                            brandNameInput.required = true;
                            break;
                    }
                    
                    // Update parent container to adjust grid
                    const parentGrid = brandNameContainer.parentElement;
                    if (selectedSearchType === 'verbal' || selectedSearchType === 'figurative') {
                        parentGrid.classList.remove('lg:grid-cols-2');
                        parentGrid.classList.add('lg:grid-cols-1');
                    } else {
                        parentGrid.classList.remove('lg:grid-cols-1');
                        parentGrid.classList.add('lg:grid-cols-2');
                    }
                });
            });
            
            // Trigger initial setup
            searchTypeInputs[0].dispatchEvent(new Event('change'));
        }

        // Country Selection
        function initializeCountrySelection() {
            const countryButtons = elements.countrySelection.querySelectorAll('.country-pill');
            
            countryButtons.forEach(button => {
                button.addEventListener('click', () => {
                    const country = button.dataset.country;
                    
                    if (selectedCountries.includes(country)) {
                        selectedCountries = selectedCountries.filter(c => c !== country);
                        button.classList.remove('selected');
                    } else {
                        selectedCountries.push(country);
                        button.classList.add('selected');
                    }
                    
                    // Ensure at least one country is selected
                    if (selectedCountries.length === 0) {
                        selectedCountries = ['EU'];
                        document.querySelector('[data-country="EU"]').classList.add('selected');
                    }
                });
                
                // Set initial selection
                if (selectedCountries.includes(button.dataset.country)) {
                    button.classList.add('selected');
                }
            });
        }

        // Image Upload
        function initializeImageUpload() {
            // Click to upload
            elements.imageUploadArea.addEventListener('click', () => {
                elements.imageInput.click();
            });

            // Drag and drop
            elements.imageUploadArea.addEventListener('dragover', (e) => {
                e.preventDefault();
                elements.imageUploadArea.classList.add('drag-over');
            });

            elements.imageUploadArea.addEventListener('dragleave', () => {
                elements.imageUploadArea.classList.remove('drag-over');
            });

            elements.imageUploadArea.addEventListener('drop', (e) => {
                e.preventDefault();
                elements.imageUploadArea.classList.remove('drag-over');
                
                const files = e.dataTransfer.files;
                if (files.length > 0) {
                    handleImageFile(files[0]);
                }
            });

            // File input change
            elements.imageInput.addEventListener('change', (e) => {
                if (e.target.files.length > 0) {
                    handleImageFile(e.target.files[0]);
                }
            });

            // Remove image
            elements.removeImage.addEventListener('click', () => {
                uploadedImage = null;
                elements.imageInput.value = '';
                elements.uploadPlaceholder.classList.remove('hidden');
                elements.imagePreviewContainer.classList.add('hidden');
            });
        }

        function handleImageFile(file) {
            // Validate file
            if (!file.type.startsWith('image/')) {
                alert('Per favore carica un file immagine valido');
                return;
            }

            if (file.size > 10 * 1024 * 1024) {
                alert('L\'immagine deve essere inferiore a 10MB');
                return;
            }

            // Read and display image
            const reader = new FileReader();
            reader.onload = (e) => {
                try {
                    const base64Data = e.target.result.split(',')[1];
                    if (!base64Data) {
                        throw new Error('Impossibile leggere l\'immagine');
                    }
                    
                    uploadedImage = {
                        base64: base64Data,
                        mimeType: file.type
                    };
                    
                    console.log('Immagine caricata:', {
                        size: base64Data.length,
                        type: file.type
                    });
                    
                    elements.imagePreview.src = e.target.result;
                    elements.uploadPlaceholder.classList.add('hidden');
                    elements.imagePreviewContainer.classList.remove('hidden');
                } catch (error) {
                    console.error('Errore caricamento immagine:', error);
                    alert('Errore nel caricamento dell\'immagine. Riprova con un\'altra immagine.');
                    uploadedImage = null;
                }
            };
            reader.onerror = () => {
                alert('Impossibile leggere il file immagine');
                uploadedImage = null;
            };
            reader.readAsDataURL(file);
        }

        // Tabs
        function initializeTabs() {
            const tabButtons = document.querySelectorAll('.tab-button');
            
            tabButtons.forEach(button => {
                button.addEventListener('click', () => {
                    const tabName = button.dataset.tab;
                    
                    // Update active button
                    tabButtons.forEach(btn => btn.classList.remove('active'));
                    button.classList.add('active');
                    
                    // Show corresponding content
                    document.querySelectorAll('.tab-content').forEach(content => {
                        content.classList.add('hidden');
                    });
                    document.getElementById(tabName + 'Tab').classList.remove('hidden');
                });
            });
        }

        // FAQ
        function initializeFAQ() {
            const faqItems = document.querySelectorAll('.faq-item');
            
            faqItems.forEach(item => {
                const question = item.querySelector('.faq-question');
                
                question.addEventListener('click', () => {
                    const isActive = item.classList.contains('active');
                    
                    // Close all items
                    faqItems.forEach(i => i.classList.remove('active'));
                    
                    // Open clicked item if it wasn't active
                    if (!isActive) {
                        item.classList.add('active');
                    }
                });
            });
        }

        // Form Handlers
        function initializeFormHandlers() {
            elements.searchForm.addEventListener('submit', handleFormSubmit);
            elements.newSearch.addEventListener('click', resetForm);
            elements.downloadReport.addEventListener('click', handleDownloadReport);
        }

        async function handleFormSubmit(e) {
            e.preventDefault();
            
            // Validate based on search type
            let brandName = '';
            let hasValidInput = false;
            
            switch(selectedSearchType) {
                case 'verbal':
                    brandName = elements.brandName.value.trim();
                    hasValidInput = brandName !== '';
                    break;
                    
                case 'figurative':
                    brandName = 'Marchio Figurativo'; // Default name for figurative-only
                    hasValidInput = uploadedImage !== null;
                    if (!hasValidInput) {
                        alert('Per favore carica un\'immagine del marchio figurativo');
                        return;
                    }
                    break;
                    
                case 'combined':
                    brandName = elements.brandName.value.trim();
                    hasValidInput = brandName !== '' && uploadedImage !== null;
                    if (!uploadedImage) {
                        alert('Per un marchio complesso, carica anche l\'immagine del logo');
                        return;
                    }
                    break;
            }
            
            const productDescription = elements.productDescription.value.trim();
            
            if (!hasValidInput || !productDescription || selectedCountries.length === 0) {
                alert('Per favore compila tutti i campi richiesti');
                return;
            }
            
            // Show loading state
            showLoading();
            
            try {
                // Pass search type to API
                const results = await api.searchBrand(
                    brandName, 
                    productDescription, 
                    selectedCountries, 
                    uploadedImage,
                    selectedSearchType
                );
                
                if (results.success) {
                    currentResults = results.data;
                    displayResults(results.data);
                } else {
                    throw new Error('Errore durante l\'analisi');
                }
            } catch (error) {
                console.error('Error:', error);
                alert('Si è verificato un errore durante l\'analisi. Riprova più tardi.');
                hideLoading();
            }
        }

        function showLoading() {
            elements.searchForm.parentElement.style.display = 'none';
            elements.resultsSection.classList.add('hidden');
            elements.loadingState.classList.remove('hidden');
            
            // Animate loading messages
            const messages = [
                'Interrogazione database EUIPO',
                'Analisi semantica del marchio',
                'Identificazione classi di Nizza',
                'Confronto con marchi esistenti',
                'Generazione giudizio legale'
            ];
            
            if (uploadedImage) {
                messages.splice(2, 0, 'Analisi elementi figurativi del logo');
                messages.push('Confronto visivo con marchi figurativi');
            }
            
            let messageIndex = 0;
            const messageInterval = setInterval(() => {
                if (messageIndex < messages.length) {
                    elements.loadingMessage.textContent = messages[messageIndex];
                    messageIndex++;
                } else {
                    clearInterval(messageInterval);
                }
            }, 2000);
        }

        function hideLoading() {
            elements.loadingState.classList.add('hidden');
            elements.searchForm.parentElement.style.display = 'block';
        }

        function displayResults(data) {
            elements.loadingState.classList.add('hidden');
            elements.resultsSection.classList.remove('hidden');
            
            // Display score with animation
            animateScore(data.score);
            
            // Display classes
            renderClasses(data.classes);
            
            // Display image analysis if present
            if (data.imageAnalysis) {
                console.log('Mostrando analisi immagine:', data.imageAnalysis);
                renderImageAnalysis(data.imageAnalysis);
                elements.imageAnalysisCard.style.display = 'block';
                elements.imageAnalysisCheck.style.display = 'flex';
            } else {
                console.log('Nessuna analisi immagine da mostrare');
                elements.imageAnalysisCard.style.display = 'none';
                elements.imageAnalysisCheck.style.display = 'none';
            }
            
            // Show/hide tabs based on search type and results
            const verbalTabButton = document.querySelector('[data-tab="verbal"]');
            const figurativeTabButton = elements.figurativeTabButton;
            
            // Show verbal tab only if we have verbal results or it's not a figurative-only search
            if (selectedSearchType !== 'figurative' && data.verbalMarks && data.verbalMarks.length > 0) {
                verbalTabButton.style.display = 'inline-flex';
            } else {
                verbalTabButton.style.display = 'none';
            }
            
            // Show figurative tab only if we have figurative results
            if (data.figurativeMarks && data.figurativeMarks.length > 0) {
                figurativeTabButton.style.display = 'inline-flex';
            } else {
                figurativeTabButton.style.display = 'none';
            }
            
            // Display judgment
            renderJudgment(data.judgment);
            
            // Display marks
            renderVerbalMarks(data.verbalMarks || []);
            
            // Display figurative marks if present
            if (data.figurativeMarks && data.figurativeMarks.length > 0) {
                console.log('Mostrando marchi figurativi:', data.figurativeMarks.length);
                renderFigurativeMarks(data.figurativeMarks);
            } else {
                console.log('Nessun marchio figurativo da mostrare');
                renderFigurativeMarks([]);
            }
            
            // Reset to judgment tab
            document.querySelectorAll('.tab-button').forEach(btn => btn.classList.remove('active'));
            document.querySelector('[data-tab="judgment"]').classList.add('active');
            document.querySelectorAll('.tab-content').forEach(content => content.classList.add('hidden'));
            document.getElementById('judgmentTab').classList.remove('hidden');
            
            // Scroll to results
            elements.resultsSection.scrollIntoView({ behavior: 'smooth', block: 'start' });
        }

        function animateScore(targetScore) {
            const duration = 2000;
            const startTime = Date.now();
            const circumference = 2 * Math.PI * 70;
            
            function update() {
                const elapsed = Date.now() - startTime;
                const progress = Math.min(elapsed / duration, 1);
                
                // Easing function
                const easeOutQuart = 1 - Math.pow(1 - progress, 4);
                
                // Update score value
                const currentScore = Math.round(targetScore * easeOutQuart);
                elements.scoreValue.textContent = currentScore;
                
                // Update circle
                const offset = circumference - (circumference * currentScore / 100);
                elements.scoreCircle.style.strokeDashoffset = offset;
                
                // Update color based on score
                let color = '#10b981'; // green
                if (currentScore < 60) color = '#ef4444'; // red
                else if (currentScore < 80) color = '#f59e0b'; // yellow
                
                if (progress < 1) {
                    requestAnimationFrame(update);
                }
            }
            
            requestAnimationFrame(update);
        }

        function renderClasses(classes) {
            const classesHtml = classes.map(cls => `
                <div class="p-4 bg-slate-50 rounded-lg border border-slate-200">
                    <div class="flex items-start gap-3">
                        <span class="flex-shrink-0 text-2xl font-bold gradient-text">${cls.number}</span>
                        <div>
                            <h4 class="font-semibold text-slate-900">${cls.title || cls.name}</h4>
                            <p class="text-sm text-slate-600 mt-1">${cls.description}</p>
                        </div>
                    </div>
                </div>
            `).join('');
            
            elements.aiClassesContainer.innerHTML = classesHtml;
        }

        function renderImageAnalysis(analysis) {
            elements.imageDescription.textContent = analysis.description;
            
            // Distinctive elements
            const elementsHtml = analysis.distinctiveElements.map(element => `
                <span class="px-3 py-1 bg-purple-100 text-purple-700 rounded-full text-sm font-medium">
                    ${element}
                </span>
            `).join('');
            elements.distinctiveElements.innerHTML = elementsHtml;
            
            // Vienna codes
            const codesHtml = analysis.viennaCodes.map(code => `
                <div class="flex items-center gap-2">
                    <span class="font-mono bg-slate-100 px-2 py-1 rounded text-sm">${code}</span>
                    <span class="text-sm text-slate-600">${getViennaDescription(code)}</span>
                </div>
            `).join('');
            elements.viennaCodes.innerHTML = codesHtml;
        }

        function getViennaDescription(code) {
            const descriptions = {
                "1": "Corpi celesti",
                "2": "Esseri umani",
                "3": "Animali",
                "4": "Esseri fantastici",
                "5": "Piante",
                "6": "Paesaggi",
                "7": "Costruzioni",
                "25": "Motivi ornamentali",
                "26": "Figure geometriche",
                "27": "Forme di scrittura"
            };
            return descriptions[code] || "Altro elemento";
        }

        function renderJudgment(judgment) {
            // Update icon based on level
            const icons = {
                positive: '<i class="fas fa-check-circle text-green-500"></i>',
                warning: '<i class="fas fa-exclamation-circle text-yellow-500"></i>',
                negative: '<i class="fas fa-times-circle text-red-500"></i>'
            };
            
            elements.judgmentIcon.innerHTML = icons[judgment.level] || icons.warning;
            elements.judgmentSummary.textContent = judgment.summary;
            elements.judgmentDetails.innerHTML = judgment.details;
        }

        function renderVerbalMarks(marks) {
            if (marks.length === 0) {
                elements.verbalMarksContainer.innerHTML = `
                    <div class="text-center py-8 text-slate-500">
                        <i class="fas fa-check-circle text-4xl mb-2"></i>
                        <p>Nessun marchio verbale simile trovato</p>
                    </div>
                `;
                return;
            }
            
            const marksHtml = marks.map(mark => `
                <div class="p-4 bg-white rounded-lg border border-slate-200 hover:border-slate-300 transition-colors">
                    <div class="flex justify-between items-start mb-2">
                        <h4 class="font-semibold text-slate-900">${mark.name}</h4>
                        <span class="text-sm px-2 py-1 rounded-full ${
                            mark.similarity >= 80 ? 'bg-red-100 text-red-700' : 
                            mark.similarity >= 60 ? 'bg-yellow-100 text-yellow-700' : 
                            'bg-green-100 text-green-700'
                        }">
                            ${mark.similarity}% similarità
                        </span>
                    </div>
                    <div class="text-sm text-slate-600 space-y-1">
                        <p><strong>Numero:</strong> ${mark.applicationNumber || mark.number}</p>
                        <p><strong>Stato:</strong> ${mark.status}</p>
                        <p><strong>Classi:</strong> ${mark.classes}</p>
                        <p><strong>Titolare:</strong> ${mark.owner}</p>
                    </div>
                </div>
            `).join('');
            
            elements.verbalMarksContainer.innerHTML = marksHtml;
        }

        function renderFigurativeMarks(marks) {
            if (marks.length === 0) {
                elements.figurativeMarksContainer.innerHTML = `
                    <div class="text-center py-8 text-slate-500">
                        <i class="fas fa-image text-4xl mb-2"></i>
                        <p>Nessun marchio figurativo simile trovato</p>
                    </div>
                `;
                return;
            }
            
            const marksHtml = marks.map(mark => `
                <div class="figurative-mark-card">
                    <div class="figurative-mark-image">
                        ${mark.imageUrl ? 
                            `<img src="${mark.imageUrl}" alt="${mark.name}">` :
                            '<i class="fas fa-image text-2xl text-slate-400"></i>'
                        }
                    </div>
                    <div class="flex-1">
                        <h4 class="font-semibold text-slate-900 mb-1">${mark.name}</h4>
                        <div class="text-sm text-slate-600 space-y-1">
                            <p><strong>Numero:</strong> ${mark.applicationNumber}</p>
                            <p><strong>Stato:</strong> ${mark.status}</p>
                            <p><strong>Classi:</strong> ${mark.classes}</p>
                            ${mark.visualComparison ? `
                                <div class="mt-2 p-2 bg-slate-50 rounded">
                                    <p class="font-medium">Confronto Visivo:</p>
                                    <p>Similarità: ${mark.visualComparison.visualSimilarity}%</p>
                                    <p>Rischio: <span class="${
                                        mark.visualComparison.confusionRisk === 'ALTO' ? 'text-red-600' :
                                        mark.visualComparison.confusionRisk === 'MEDIO' ? 'text-yellow-600' :
                                        'text-green-600'
                                    }">${mark.visualComparison.confusionRisk}</span></p>
                                    <p class="text-xs mt-1">${mark.visualComparison.reasoning}</p>
                                </div>
                            ` : ''}
                        </div>
                    </div>
                </div>
            `).join('');
            
            elements.figurativeMarksContainer.innerHTML = marksHtml;
        }

        function resetForm() {
            elements.searchForm.reset();
            uploadedImage = null;
            elements.uploadPlaceholder.classList.remove('hidden');
            elements.imagePreviewContainer.classList.add('hidden');
            selectedCountries = ['EU'];
            selectedSearchType = 'verbal';
            initializeCountrySelection();
            // Reset search type to verbal
            document.querySelector('input[name="searchType"][value="verbal"]').checked = true;
            document.querySelector('input[name="searchType"][value="verbal"]').dispatchEvent(new Event('change'));
            elements.resultsSection.classList.add('hidden');
            elements.searchForm.parentElement.style.display = 'block';
            window.scrollTo({ top: 0, behavior: 'smooth' });
        }

        function handleDownloadReport() {
            alert('Funzionalità di download report in fase di sviluppo. Il report completo sarà disponibile a breve!');
            // Here you would implement PDF generation
        }

        // API functions
        const api = {
            async searchBrand(brandName, products, countries, imageData, searchType) {
                try {
                    // CONFIGURAZIONE BACKEND:
                    // 1. Sostituisci 'your-vercel-domain' con il tuo dominio Vercel reale
                    // 2. Assicurati che le variabili d'ambiente EUIPO_CLIENT_ID e EUIPO_CLIENT_SECRET 
                    //    siano configurate nel tuo progetto Vercel
                    // 3. Per testare in locale, usa: http://localhost:3000/api/search
                    const BACKEND_URL = 'https://your-vercel-domain.vercel.app/api/search';
                    
                    // Debug: verifica se l'immagine viene passata
                    console.log('Invio richiesta con immagine:', imageData ? 'Sì' : 'No');
                    console.log('Tipo di ricerca:', searchType);
                    
                    const response = await fetch(BACKEND_URL, {
                        method: 'POST',
                        headers: {
                            'Content-Type': 'application/json'
                        },
                        body: JSON.stringify({
                            brandName: brandName,
                            productDescription: products,
                            selectedCountries: countries,
                            imageData: imageData,
                            searchType: searchType || 'verbal'
                        })
                    });
                    
                    if (!response.ok) {
                        const errorData = await response.json();
                        throw new Error(errorData.message || 'Errore nella ricerca');
                    }
                    
                    const data = await response.json();
                    
                    // Debug: verifica la risposta
                    console.log('Risposta ricevuta:', data);
                    
                    // Adatta la risposta al formato atteso dal frontend
                    return {
                        success: true,
                        data: {
                            brand: brandName,
                            score: data.brandScore,
                            classes: data.identifiedClasses,
                            imageAnalysis: data.imageAnalysis,
                            judgment: {
                                level: this.mapRiskLevel(data.riskLevel),
                                summary: this.extractSummary(data.syntheticJudgment),
                                details: data.syntheticJudgment
                            },
                            verbalMarks: data.verbalMarks,
                            figurativeMarks: data.figurativeMarks
                        }
                    };
                } catch (error) {
                    console.error('Errore API:', error);
                    // Fallback ai dati mock se l'API non è disponibile
                    return this.generateMockData(brandName, products, countries, imageData, searchType);
                }
            },
            
            mapRiskLevel(riskLevel) {
                const mapping = {
                    'BASSO': 'positive',
                    'MODERATO': 'warning',
                    'ALTO': 'negative',
                    'MOLTO ALTO': 'negative'
                };
                return mapping[riskLevel] || 'warning';
            },
            
            extractSummary(judgment) {
                // Estrai il livello di rischio dal giudizio
                const riskMatch = judgment.match(/RISCHIO[^:]*:[^A-Z]*(BASSO|MODERATO|ALTO|MOLTO ALTO)/i);
                if (riskMatch) {
                    const risk = riskMatch[1];
                    const summaries = {
                        'BASSO': 'Ottima registrabilità',
                        'MODERATO': 'Registrabilità con riserve',
                        'ALTO': 'Registrabilità critica',
                        'MOLTO ALTO': 'Registrabilità fortemente sconsigliata'
                    };
                    return summaries[risk] || 'Valutazione in corso';
                }
                return 'Analisi completata';
            },
            
            // Dati mock di fallback
            async generateMockData(brandName, products, countries, imageData, searchType) {
                // Simulate API delay
                await new Promise(resolve => setTimeout(resolve, 3000));
                
                const score = Math.floor(Math.random() * 40) + 55;
                const classes = this.generateClasses(products);
                const judgment = this.generateJudgment(score);
                const verbalMarks = (searchType !== 'figurative') ? this.generateVerbalMarks(brandName) : [];
                const figurativeMarks = (imageData || searchType === 'figurative') ? this.generateFigurativeMarks() : [];
                const imageAnalysis = (imageData || searchType === 'figurative') ? this.generateImageAnalysis() : null;
                
                return {
                    success: true,
                    data: {
                        brand: brandName,
                        score: score,
                        classes: classes,
                        imageAnalysis: imageAnalysis,
                        judgment: judgment,
                        verbalMarks: verbalMarks,
                        figurativeMarks: figurativeMarks
                    }
                };
            },
            
            generateClasses(products) {
                const allClasses = [
                    { number: 9, title: "Software e apparecchi scientifici", description: "Apparecchi e strumenti scientifici, software, hardware informatico" },
                    { number: 35, title: "Pubblicità e gestione aziendale", description: "Servizi di pubblicità, gestione degli affari commerciali, amministrazione" },
                    { number: 42, title: "Servizi scientifici e tecnologici", description: "Servizi scientifici e tecnologici, ricerca e progettazione, sviluppo software" },
                    { number: 45, title: "Servizi giuridici e di sicurezza", description: "Servizi giuridici, servizi di sicurezza per la protezione di beni e individui" }
                ];
                return allClasses.slice(0, Math.floor(Math.random() * 2) + 2);
            },
            
            generateImageAnalysis() {
                return {
                    description: "Logo moderno con elementi geometrici e tipografia sans-serif",
                    distinctiveElements: ["Forma circolare", "Gradiente blu", "Lettering stilizzato"],
                    viennaCodes: ["26", "27", "29"]
                };
            },
            
            generateJudgment(score) {
                if (score >= 80) {
                    return {
                        level: "positive",
                        summary: "Ottima registrabilità",
                        details: `<h4>VALUTAZIONE DEL RISCHIO: BASSO</h4>
                        <p>L'analisi evidenzia un <strong>rischio basso</strong> di conflitti. Il marchio proposto presenta <span class='highlight'>caratteri distintivi forti</span> e non sono state rilevate anteriorità bloccanti.</p>
                        <p><strong>Riferimenti normativi:</strong> Art. 7 CPI (Novità), Art. 8 EUTMR (Impedimenti relativi)</p>`
                    };
                } else if (score >= 60) {
                    return {
                        level: "warning",
                        summary: "Registrabilità con riserve",
                        details: `<h4>VALUTAZIONE DEL RISCHIO: MODERATO</h4>
                        <p>Sono state rilevate <strong>similitudini moderate</strong> con marchi esistenti. Si consiglia una <span class='highlight'>valutazione approfondita</span> per le classi indicate.</p>
                        <p><strong>Riferimenti normativi:</strong> Art. 12 CPI (Rischio di confusione), Art. 8 EUTMR (Impedimenti relativi)</p>`
                    };
                } else {
                    return {
                        level: "negative",
                        summary: "Registrabilità critica",
                        details: `<h4>VALUTAZIONE DEL RISCHIO: ALTO</h4>
                        <p>L'analisi evidenzia <strong>rischi significativi</strong> di rigetto. Sono presenti <span class='highlight'>anteriorità rilevanti</span> che potrebbero ostacolare la registrazione.</p>
                        <p><strong>Riferimenti normativi:</strong> Art. 8 CPI (Marchi anteriori), Art. 46 EUTMR (Motivi di opposizione)</p>`
                    };
                }
            },
            
            generateVerbalMarks(brandName) {
                const variations = ["TECH", "SMART", "DIGITAL", "PLUS", "PRO"];
                const marks = [];
                const count = Math.floor(Math.random() * 3) + 2;
                
                for (let i = 0; i < count; i++) {
                    marks.push({
                        name: brandName.toUpperCase() + " " + variations[i],
                        applicationNumber: "EU" + Math.floor(Math.random() * 1000000 + 17000000),
                        status: Math.random() > 0.5 ? "Registrato" : "In domanda",
                        classes: "Cl. " + [9, 35, 42].sort(() => Math.random() - 0.5).slice(0, 2).join(', '),
                        similarity: Math.floor(Math.random() * 30) + 60,
                        owner: "Company " + String.fromCharCode(65 + i) + " S.r.l."
                    });
                }
                
                return marks.sort((a, b) => b.similarity - a.similarity);
            },
            
            generateFigurativeMarks() {
                const marks = [];
                const count = Math.floor(Math.random() * 2) + 1;
                
                for (let i = 0; i < count; i++) {
                    marks.push({
                        name: "Logo Figurativo " + (i + 1),
                        applicationNumber: "EU" + Math.floor(Math.random() * 1000000 + 18000000),
                        status: "Registrato",
                        classes: "Cl. " + [9, 35, 42].sort(() => Math.random() - 0.5).slice(0, 2).join(', '),
                        owner: "Design Company " + String.fromCharCode(65 + i) + " Ltd.",
                        imageUrl: null,
                        visualComparison: {
                            visualSimilarity: Math.floor(Math.random() * 40) + 30,
                            confusionRisk: ["BASSO", "MEDIO", "ALTO"][Math.floor(Math.random() * 3)],
                            reasoning: "Elementi grafici con disposizione simile ma colori distintivi"
                        }
                    });
                }
                
                return marks;
            }
        };
    </script>
</body>
</html>